# Violin Connect Data Layer Audit
**Generated on:** Thu Mar 20 04:38:21 EDT 2025

This audit helps identify potential issues with the data layer implementation
that might not conform to the patterns described in DATABASE_WORKFLOW.md.

## Summary

## 1. Non-UUID String IDs
These patterns suggest the code might be using simple string IDs instead of proper UUIDs:

### Pattern: 'student-[0-9]
```
src/components/lessons/AllLessonsLoader.ts:  const studentIds = ['student-1', 'student-2', 'student-3', 'student-4'];
src/hooks/useUserRoles.ts:          id: 'student-1',
src/hooks/useUserRoles.ts:          id: 'student-2',
```

### Pattern: 's-[0-9]
```
src/lib/attachment-utils.ts:    createAttachmentAssociation(bachScoreId, AttachmentEntityType.STUDENT, 's-1', false)
src/lib/attachment-utils.ts:    createAttachmentAssociation(lessonRecordingId, AttachmentEntityType.STUDENT, 's-1', false)
```

### Pattern: "s-[0-9]
```
src/lib/id-utils.ts: * @param prefixedId The full prefixed ID (e.g., "s-1")
```

### Pattern: 'p-[0-9]
```
src/backup-pre-migration-20250319205821/pages/Index.tsx:    id: 'p-1',
src/backup-pre-migration-20250319205821/pages/Index.tsx:    id: 'p-9',
src/lib/dev-uuids.ts:// Repertoire Piece UUIDs (to replace 'p-1', 'p-2', etc.)
src/lib/attachment-utils.ts:console.log('Associations for Piece p-1:', mockAttachmentAssociations.filter(a => a.entityType === AttachmentEntityType.PIECE && a.entityId === 'p-1').map(a => a.attachmentId));
src/lib/attachment-utils.ts:    possibleIds.push('p-4');  // Known ID for Paganini Caprice No.24
src/lib/attachment-utils.ts:        assoc => assoc.entityType === AttachmentEntityType.PIECE && (assoc.entityId === 'p-4' || assoc.entityId === '4')
src/lib/attachment-utils.ts:        matchedId = 'p-4';
src/lib/attachment-utils.ts:    possibleIds.push('p-4');  // Known ID for Paganini Caprice No.24
src/lib/attachment-utils.ts:        assoc => assoc.entityType === AttachmentEntityType.PIECE && (assoc.entityId === 'p-4' || assoc.entityId === '4')
src/lib/attachment-utils.ts:        matchedId = 'p-4';
src/lib/attachment-utils.ts:  for (const id of ['p-1', 'p-3', 'p-33', '3']) {
src/lib/auth-wrapper.ts:        className: 'p-4 border rounded-lg',
src/lib/auth-wrapper.ts:        className: 'p-4 border rounded-lg',
```

### Pattern: "p-[0-9]
```
src/app/layout/Sidebar.tsx:        <div className="p-6 flex items-center gap-3">
src/features/journal/components/SearchJournal.tsx:                          className="p-4 border rounded-lg cursor-pointer hover:bg-muted/40 transition-colors"
src/features/journal/pages/Journal.tsx:                                className="p-3 hover:bg-gray-50 cursor-pointer"
src/features/journal/pages/Journal.tsx:                      <div className="p-6 space-y-8">
src/features/journal/pages/Journal.tsx:                          <CardContent className="p-4 sm:p-6">
src/features/messages/components/ConversationList.tsx:        "p-4 border-b border-gray-100",
src/features/messages/components/ConversationList.tsx:          "p-2",
src/features/messages/components/ConversationList.tsx:                compactMode && "p-2 my-1 w-auto",
src/features/messages/pages/Messages.tsx:            <div className="p-4 border-b border-gray-100 min-[768px]:max-[850px]:flex min-[768px]:max-[850px]:justify-center min-[768px]:max-[850px]:p-3">
src/features/messages/pages/Messages.tsx:              <div className="p-2 min-[768px]:max-[850px]:flex min-[768px]:max-[850px]:flex-col min-[768px]:max-[850px]:items-center min-[768px]:max-[850px]:p-1">
src/features/messages/pages/Messages.tsx:                <div className="p-4 border-b border-gray-100 flex items-center gap-3 bg-gray-50">
src/features/messages/pages/Messages.tsx:                <div className="p-4 border-t border-gray-100 bg-white">
src/features/calendar/pages/Calendar.tsx:              <CardContent className="p-4">
src/features/discussions/components/PinnedInfoCard.tsx:      <CardContent className={cn("p-4 flex items-start gap-3", color)}>
src/features/discussions/pages/Discussions.tsx:              <CardContent className={cn("p-4 flex items-start gap-3", item.color)}>
src/features/auth/components/AuthCard.tsx:        <CardContent className="p-0">
src/features/repertoire/pages/PieceDetails.tsx:            <div className="p-5 bg-blue-50/30 border border-blue-100 rounded-lg">
src/features/repertoire/pages/PieceDetails.tsx:            <div className="p-5 bg-amber-50/30 border border-amber-100 rounded-lg">
src/features/repertoire/pages/Repertoire.tsx:            <div className="p-4 border rounded-lg bg-card">
src/features/repertoire/pages/Repertoire.tsx:                                        <CardContent className="p-4 flex items-center justify-between">
src/features/repertoire/pages/Repertoire.tsx:                              <CardContent className="p-4 flex items-center justify-between">
src/features/repertoire/pages/Repertoire.tsx:              <div className="p-4 text-center text-muted-foreground">
src/features/repertoire/pages/Repertoire.tsx:                    <CardContent className="p-3 flex items-center justify-between">
src/features/dashboard/pages/Dashboard.tsx:            <TabsContent value="week" className="p-5">
src/features/dashboard/pages/Dashboard.tsx:        <div className="p-5 pb-4 border-b border-gray-100">
src/features/dashboard/pages/Dashboard.tsx:        <div className="p-5 grid grid-cols-1 md:grid-cols-2 gap-5">
src/features/dashboard/pages/Dashboard.tsx:                <div className="p-5 pb-3">
src/features/dashboard/pages/StudentDashboard.tsx:                          <CardContent className="p-4">
src/features/dashboard/pages/StudentDashboard.tsx:                    <CardContent className="p-4">
src/features/dashboard/pages/StudentDashboard.tsx:                      <CardContent className="p-4">
src/features/students/components/StudentCard.tsx:      <CardHeader className="p-4 pb-2">
src/features/students/components/StudentCard.tsx:      <CardContent className="p-4 pt-2 pb-3 space-y-3 text-sm">
src/features/students/components/StudentCard.tsx:      <CardFooter className="p-0">
src/features/students/pages/Students.tsx:                <div className="p-3 bg-gray-50 rounded-md">
src/features/students/pages/StudentDetail.tsx:                                <CardContent className="p-4 flex items-start gap-3">
src/features/students/pages/StudentDetail.tsx:                                <CardContent className="p-4 flex items-start gap-3">
src/features/files/pages/Files.tsx:            <CardContent className="p-0">
src/features/files/pages/Files.tsx:            <CardContent className="p-3">
src/features/files/pages/Files.tsx:            <CardContent className="p-3 space-y-2">
src/features/files/pages/Files.tsx:            <CardContent className="p-6">
src/features/files/pages/Files.tsx:                            <CardContent className="p-0">
src/features/files/pages/Files.tsx:                              <div className="p-4">
src/features/files/pages/Files.tsx:                            <CardContent className="p-0">
src/features/files/pages/Files.tsx:                              <div className="p-4">
src/features/files/pages/Files.tsx:                            <CardContent className="p-0">
src/features/files/pages/Files.tsx:                              <div className="p-4">
src/features/files/pages/Files.tsx:                            <CardContent className="p-0">
src/features/files/pages/Files.tsx:                              <div className="p-4">
src/components/ui/card.tsx:  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
src/components/ui/calendar.tsx:      className={cn("p-3 w-full", className)}
src/components/ui/sidebar.tsx:              ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
src/components/ui/table.tsx:    className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}
src/components/ui/select.tsx:          "p-1",
src/components/layout/Sidebar.tsx:        <div className="p-6 flex items-center gap-3">
src/components/common/LessonHistory.tsx:                className="p-4 md:px-6 cursor-pointer flex justify-between items-center"
src/components/common/RepertoireItem.tsx:          "p-3 border rounded-lg transition-all duration-200 hover:bg-muted/50 cursor-pointer",
src/components/common/RepertoireItem.tsx:        "p-4 border rounded-lg transition-all duration-300 card-hover",
src/components/common/RepertoireDisplay.tsx:          className="p-0 border-0"
src/components/common/DiscussionCard.tsx:      <CardHeader className="p-4 pb-2 space-y-2">
src/components/common/DiscussionCard.tsx:      <CardContent className="p-4 pt-0">
src/components/common/DiscussionCard.tsx:      <CardFooter className="p-2 px-4 border-t bg-gray-50/50 dark:bg-gray-900/30 justify-between">
src/components/common/PieceCard.tsx:      <CardContent className="p-0">
src/components/common/InspirationOfTheDay.tsx:                  <CardContent className="p-4">
src/components/common/InspirationOfTheDay.tsx:                      <CardContent className="p-4">
src/components/common/InspirationOfTheDay.tsx:                      <CardContent className="p-4">
src/components/common/CalendarEvent.tsx:        "p-4 rounded-lg transition-all duration-200 border",
src/components/examples/MigrationExampleComponent.tsx:                  <div key={piece.id} className="p-3 border rounded-md flex justify-between">
src/components/examples/SchemaExample.tsx:    <div className="p-4 border rounded-md">
src/components/dev/HookHealthDashboard.tsx:          className="p-2 font-mono flex items-center justify-between cursor-pointer" 
src/components/dev/HookHealthDashboard.tsx:                    <th className="p-2 text-left">Hook</th>
src/components/dev/HookHealthDashboard.tsx:                    <th className="p-2 text-right">Source</th>
src/components/dev/HookHealthDashboard.tsx:                      <td colSpan={2} className="p-4 text-center text-gray-500">
src/components/dev/HookHealthDashboard.tsx:                        <td className="p-2">{name}</td>
src/backup-pre-migration-20250319205821/pages/Index.tsx:            <TabsContent value="week" className="p-5">
src/backup-pre-migration-20250319205821/pages/Index.tsx:        <div className="p-5 pb-4 border-b border-gray-100">
src/backup-pre-migration-20250319205821/pages/Index.tsx:        <div className="p-5 grid grid-cols-1 md:grid-cols-2 gap-5">
src/backup-pre-migration-20250319205821/pages/Index.tsx:                <div className="p-5 pb-3">
src/backup-pre-migration-20250319205821/pages/Students.tsx:                <div className="p-3 bg-gray-50 rounded-md">
src/backup-pre-migration-20250319205821/pages/Discussions.tsx:              <CardContent className={cn("p-4 flex items-start gap-3", item.color)}>
src/backup-pre-migration-20250319205821/pages/StudentDashboard.tsx:                          <CardContent className="p-4">
src/backup-pre-migration-20250319205821/pages/StudentDashboard.tsx:                    <CardContent className="p-4">
src/backup-pre-migration-20250319205821/pages/StudentDashboard.tsx:                      <CardContent className="p-4">
src/backup-pre-migration-20250319205821/pages/Files.tsx:            <CardContent className="p-0">
src/backup-pre-migration-20250319205821/pages/Files.tsx:            <CardContent className="p-3">
src/backup-pre-migration-20250319205821/pages/Files.tsx:            <CardContent className="p-3 space-y-2">
src/backup-pre-migration-20250319205821/pages/Files.tsx:            <CardContent className="p-6">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                            <CardContent className="p-0">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                              <div className="p-4">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                            <CardContent className="p-0">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                              <div className="p-4">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                            <CardContent className="p-0">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                              <div className="p-4">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                            <CardContent className="p-0">
src/backup-pre-migration-20250319205821/pages/Files.tsx:                              <div className="p-4">
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:            <div className="p-5 bg-blue-50/30 border border-blue-100 rounded-lg">
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:            <div className="p-5 bg-amber-50/30 border border-amber-100 rounded-lg">
src/backup-pre-migration-20250319205821/pages/Calendar.tsx:              <CardContent className="p-4">
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                                className="p-3 hover:bg-gray-50 cursor-pointer"
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                      <div className="p-6 space-y-8">
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                          <CardContent className="p-4 sm:p-6">
src/backup-pre-migration-20250319205821/pages/Messages.tsx:            <div className="p-4 border-b border-gray-100 min-[768px]:max-[850px]:flex min-[768px]:max-[850px]:justify-center min-[768px]:max-[850px]:p-3">
src/backup-pre-migration-20250319205821/pages/Messages.tsx:              <div className="p-2 min-[768px]:max-[850px]:flex min-[768px]:max-[850px]:flex-col min-[768px]:max-[850px]:items-center min-[768px]:max-[850px]:p-1">
src/backup-pre-migration-20250319205821/pages/Messages.tsx:                <div className="p-4 border-b border-gray-100 flex items-center gap-3 bg-gray-50">
src/backup-pre-migration-20250319205821/pages/Messages.tsx:                <div className="p-4 border-t border-gray-100 bg-white">
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:            <div className="p-4 border rounded-lg bg-card">
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:                                        <CardContent className="p-4 flex items-center justify-between">
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:                              <CardContent className="p-4 flex items-center justify-between">
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:              <div className="p-4 text-center text-muted-foreground">
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:                    <CardContent className="p-3 flex items-center justify-between">
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:                                <CardContent className="p-4 flex items-start gap-3">
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:                                <CardContent className="p-4 flex items-start gap-3">
src/lib/attachment-utils.ts:  const bachPieceId = `${ID_PREFIXES.PIECE}1`; // This should result in "p-1"
src/lib/attachment-utils.ts:  const paganiniPieceId = `${ID_PREFIXES.PIECE}4`; // Should result in "p-4"
```

### Pattern: 'l-[0-9]
```
src/lib/attachment-utils.ts:    createAttachmentAssociation(lessonRecordingId, AttachmentEntityType.LESSON, 'l-1', true),
```

## 2. ID Prefix Creation
These functions create prefixed IDs which might not be compatible with the database schema:

### Pattern: createPrefixedId
```
src/features/repertoire/pages/Repertoire.tsx:import { ID_PREFIXES, createPrefixedId, createStudentPieceId, getIdWithoutPrefix, ensureIdHasPrefix, isIdOfType, logIdInconsistency } from '@/lib/id-utils';
src/features/dashboard/pages/Dashboard.tsx:import { ID_PREFIXES, createPrefixedId, isValidUUID } from '@/lib/id-utils';
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '101'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '102'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '103'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '201'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '202'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '203'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '301'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '302'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '303'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '401'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '402'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '403'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '501'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '502'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '503'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '601'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '602'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '603'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '101'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '102'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '103'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '201'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '202'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '203'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '301'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '302'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '303'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '401'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '402'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '403'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '501'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '502'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '503'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '601'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '602'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '603'),
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:import { ID_PREFIXES, createPrefixedId, createStudentPieceId, getIdWithoutPrefix, ensureIdHasPrefix, isIdOfType, logIdInconsistency } from '@/lib/id-utils';
src/scripts/seedSupabase.ts:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/scripts/seedSupabase.ts:          : createPrefixedId(ID_PREFIXES.PIECE, oldPiece.id);
src/scripts/seedSupabase.ts:            : createPrefixedId(ID_PREFIXES.STUDENT, oldStudent.id);
src/lib/migrations/migrate-all-pieces.ts:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/lib/attachment-utils.ts:import { ID_PREFIXES, createPrefixedId, getIdWithoutPrefix } from './id-utils';
src/lib/attachment-utils.ts:  return createPrefixedId(prefix, id);
src/data/mockStudents.ts:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/data/mockStudents.ts:    id: createPrefixedId(ID_PREFIXES.STUDENT, '1'),
src/data/mockStudents.ts:        id: createPrefixedId(ID_PREFIXES.LESSON, '101'),
src/data/mockStudents.ts:    id: createPrefixedId(ID_PREFIXES.STUDENT, '2'),
src/data/mockStudents.ts:        id: createPrefixedId(ID_PREFIXES.LESSON, '601'),
```

### Pattern: ID_PREFIXES
```
src/features/repertoire/hooks/useMasterRepertoire.ts:import { ID_PREFIXES, getIdWithoutPrefix } from '@/lib/id-utils';
src/features/repertoire/pages/Repertoire.tsx:import { ID_PREFIXES, createPrefixedId, createStudentPieceId, getIdWithoutPrefix, ensureIdHasPrefix, isIdOfType, logIdInconsistency } from '@/lib/id-utils';
src/features/repertoire/pages/Repertoire.tsx:    return piece.id.replace(ID_PREFIXES.PIECE, '').split('_').join(' ');
src/features/dashboard/pages/Dashboard.tsx:import { ID_PREFIXES, createPrefixedId, isValidUUID } from '@/lib/id-utils';
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '101'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '102'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '103'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '201'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '202'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '203'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '301'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '302'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '303'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '401'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '402'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '403'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '501'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '502'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '503'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '601'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '602'),
src/features/dashboard/pages/Dashboard.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '603'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '101'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '102'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '103'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '201'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '202'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '203'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '301'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '302'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '303'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '401'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '402'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '403'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '501'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '502'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '503'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '601'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '602'),
src/backup-pre-migration-20250319205821/pages/Index.tsx:        id: createPrefixedId(ID_PREFIXES.LESSON, '603'),
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:import { ID_PREFIXES, createPrefixedId, createStudentPieceId, getIdWithoutPrefix, ensureIdHasPrefix, isIdOfType, logIdInconsistency } from '@/lib/id-utils';
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:    return piece.id.replace(ID_PREFIXES.PIECE, '').split('_').join(' ');
src/scripts/seedSupabase.ts:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/scripts/seedSupabase.ts:        const oldId = oldPiece.id.startsWith(ID_PREFIXES.PIECE) 
src/scripts/seedSupabase.ts:          : createPrefixedId(ID_PREFIXES.PIECE, oldPiece.id);
src/scripts/seedSupabase.ts:          const oldId = oldStudent.id.startsWith(ID_PREFIXES.STUDENT) 
src/scripts/seedSupabase.ts:            : createPrefixedId(ID_PREFIXES.STUDENT, oldStudent.id);
src/lib/migrations/migrate-all-pieces.ts:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/lib/attachment-utils.ts:import { ID_PREFIXES, createPrefixedId, getIdWithoutPrefix } from './id-utils';
src/lib/attachment-utils.ts:  const prefix = isLink ? ID_PREFIXES.LINK : ID_PREFIXES.FILE;
src/lib/attachment-utils.ts:  const bachPieceId = `${ID_PREFIXES.PIECE}1`; // This should result in "p-1"
src/lib/attachment-utils.ts:  const paganiniPieceId = `${ID_PREFIXES.PIECE}4`; // Should result in "p-4"
src/data/mockStudents.ts:import { ID_PREFIXES, createPrefixedId } from '@/lib/id-utils';
src/data/mockStudents.ts:    id: createPrefixedId(ID_PREFIXES.STUDENT, '1'),
src/data/mockStudents.ts:        id: createPrefixedId(ID_PREFIXES.LESSON, '101'),
src/data/mockStudents.ts:    id: createPrefixedId(ID_PREFIXES.STUDENT, '2'),
src/data/mockStudents.ts:        id: createPrefixedId(ID_PREFIXES.LESSON, '601'),
```

### Pattern: getIdWithoutPrefix
```
src/features/repertoire/hooks/useMasterRepertoire.ts:import { ID_PREFIXES, getIdWithoutPrefix } from '@/lib/id-utils';
src/features/repertoire/pages/Repertoire.tsx:import { ID_PREFIXES, createPrefixedId, createStudentPieceId, getIdWithoutPrefix, ensureIdHasPrefix, isIdOfType, logIdInconsistency } from '@/lib/id-utils';
src/backup-pre-migration-20250319205821/pages/Repertoire.tsx:import { ID_PREFIXES, createPrefixedId, createStudentPieceId, getIdWithoutPrefix, ensureIdHasPrefix, isIdOfType, logIdInconsistency } from '@/lib/id-utils';
src/lib/attachment-utils.ts:import { ID_PREFIXES, createPrefixedId, getIdWithoutPrefix } from './id-utils';
```

## 3. UUID Usage
Components should import and use UUIDs from dev-uuids.ts:

### Hooks missing dev-uuid imports
```
src/features/journal/hooks/useJournalMutations.ts
src/features/journal/hooks/useJournalEntryByDate.ts
src/features/journal/hooks/useJournalEntry.ts
src/features/journal/hooks/useJournalEntries.ts
src/features/journal/hooks/useJournalInsights.ts
src/features/journal/hooks/useSearchJournalEntries.ts
src/features/messages/hooks/useMessages.ts
src/features/calendar/hooks/useCalendarMutations.ts
src/features/calendar/hooks/useCalendarEvents.ts
src/features/calendar/hooks/useLessons.ts
src/features/calendar/hooks/useCalendarEvent.ts
src/features/discussions/hooks/useDiscussions.ts
src/features/repertoire/hooks/usePieceStudentHistory.ts
src/features/repertoire/hooks/useRepertoireLinks.ts
src/features/repertoire/hooks/useRepertoireFiles.ts
src/features/repertoire/hooks/useMasterRepertoire.ts
src/features/user/hooks/useUserSettings.ts
src/features/user/hooks/useUserProfile.ts
src/features/files/hooks/useAttachments.ts
src/components/ui/use-toast.ts
src/hooks/useSupabaseAuth.ts
src/hooks/useStudentsDb.ts
src/hooks/usePieceStudentHistory.ts
src/hooks/useRepertoireLinks.ts
src/hooks/useRepertoireFiles.ts
src/hooks/use-toast.ts
src/hooks/useStudentProfile.ts
src/hooks/useUserRoles.ts
src/hooks/useStudentColor.ts
src/hooks/useLocalStorage.ts
src/hooks/useStudents.ts
src/hooks/useCalendarEvents.ts
src/hooks/useTeacher.ts
src/hooks/useJournal.ts
src/hooks/useRepertoireAttachments.ts
src/hooks/useStudentDashboard.ts
src/hooks/useStudentRepertoire.ts
src/hooks/useInvitations.ts
src/hooks/useDevFallbackUser.ts
```
Total hooks missing dev-uuid imports: 39

## 4. Hybrid Caching Approach
Hooks should follow the database → cache → mock data pattern:

### Pattern: setCachedMockData
```
src/features/journal/hooks/useJournalMutations.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/journal/hooks/useJournalMutations.ts:        setCachedMockData('journalEntries', updatedData);
src/features/journal/hooks/useJournalMutations.ts:        setCachedMockData('journalEntries', updatedData);
src/features/journal/hooks/useJournalMutations.ts:        setCachedMockData('journalEntries', updatedData);
src/features/calendar/hooks/useLessons.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/calendar/hooks/useLessons.ts:          setCachedMockData('lessons', mockLessons);
src/features/calendar/hooks/useLessons.ts:          setCachedMockData(cacheKey, mockLessons);
src/features/calendar/hooks/useLessons.ts:        setCachedMockData('lessons', [mockLesson, ...cachedLessons]);
src/features/calendar/hooks/useLessons.ts:        setCachedMockData('lessons', updatedLessons);
src/features/calendar/hooks/useLessons.ts:        setCachedMockData('lessons', updatedLessons);
src/features/calendar/hooks/useLessons.ts:        setCachedMockData('lessons', [mockLesson, ...cachedLessons]);
src/features/calendar/hooks/useLessons.ts:        setCachedMockData('calendar_events', [mockEvent, ...cachedEvents]);
src/features/repertoire/hooks/useMasterRepertoire.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/repertoire/hooks/useMasterRepertoire.ts:          setCachedMockData(cacheKey, data);
src/features/repertoire/hooks/useMasterRepertoire.ts:        setCachedMockData(cacheKey, mockData);
src/features/repertoire/hooks/useMasterRepertoire.ts:            setCachedMockData(cacheKey, data);
src/features/repertoire/hooks/useMasterRepertoire.ts:            setCachedMockData(cacheKey, fallbackPiece);
src/features/repertoire/hooks/useMasterRepertoire.ts:        setCachedMockData('masterRepertoire', [...existingData, mockPiece]);
src/features/repertoire/hooks/useMasterRepertoire.ts:        setCachedMockData('masterRepertoire', updatedData);
src/features/repertoire/hooks/useMasterRepertoire.ts:        setCachedMockData('masterRepertoire', updatedData);
src/features/repertoire/hooks/useStudentRepertoire.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/repertoire/hooks/useStudentRepertoire.ts:        setCachedMockData(mockCacheKey, mockData);
src/features/repertoire/hooks/useStudentRepertoire.ts:        setCachedMockData(cacheKey, [...existingData, mockData]);
src/features/repertoire/hooks/useStudentRepertoire.ts:        setCachedMockData(cacheKey, updatedData);
src/features/repertoire/hooks/useStudentRepertoire.ts:              setCachedMockData(key.replace('mock_', ''), filteredData);
src/components/lessons/AllLessonsLoader.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/components/lessons/AllLessonsLoader.ts:      setCachedMockData(CACHE_KEY, JSON.stringify(filteredLessons));
src/components/lessons/AllLessonsLoader.ts:    setCachedMockData(CACHE_KEY, JSON.stringify(mockLessons));
src/hooks/usePieceStudentHistory.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/hooks/usePieceStudentHistory.ts:      setCachedMockData(cacheKey, filteredMockHistory);
src/hooks/useRepertoireLinks.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/hooks/useRepertoireLinks.ts:      setCachedMockData(cacheKey, filteredMockLinks);
src/hooks/useRepertoireLinks.ts:          setCachedMockData(cacheKey, newCachedData);
src/hooks/useRepertoireLinks.ts:          setCachedMockData(cacheKey, newCachedData);
src/hooks/useRepertoireFiles.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/hooks/useRepertoireFiles.ts:      setCachedMockData(cacheKey, filteredMockFiles);
src/hooks/useRepertoireFiles.ts:          setCachedMockData(cacheKey, newCachedData);
src/hooks/useRepertoireFiles.ts:          setCachedMockData(cacheKey, newCachedData);
src/hooks/useStudentProfile.ts:import { setCachedMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useStudentProfile.ts:    setCachedMockData(profileCacheKey, data);
src/hooks/useStudentProfile.ts:    setCachedMockData(studentCacheKey, data);
src/hooks/useStudentProfile.ts:            setCachedMockData(cacheKey, lesson);
src/hooks/useStudentProfile.ts:          setCachedMockData(cacheKey, lessons[0]);
src/hooks/useStudentProfile.ts:          setCachedMockData(cacheKey, mockNextLesson);
src/hooks/useStudents.ts:import { setCachedMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useStudents.ts:          setCachedMockData('students', data);
src/hooks/useStudents.ts:          setCachedMockData(cacheKey, data);
src/hooks/useStudents.ts:        setCachedMockData(`student_${data.id}`, data);
src/hooks/useStudents.ts:        setCachedMockData(`student_${id}`, data);
src/hooks/useStudents.ts:        setCachedMockData('students', updatedCache);
src/hooks/useStudents.ts:        setCachedMockData('students', updatedCache);
src/hooks/useJournal.ts:import { setCachedMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useJournal.ts:          setCachedMockData('journalEntries_' + userId, data);
src/hooks/useJournal.ts:        setCachedMockData('journalEntries_' + userId, sortedEntries);
src/hooks/useJournal.ts:          setCachedMockData(`journalEntry_${id}_${userId}`, entryData);
src/hooks/useJournal.ts:          setCachedMockData(`journalEntry_${id}_${userId}`, mockEntry);
src/hooks/useJournal.ts:          setCachedMockData(`journalEntry_${formattedDate}_${userId}`, data);
src/hooks/useJournal.ts:          setCachedMockData(`journalEntry_${formattedDate}_${userId}`, mockEntry);
src/hooks/useJournal.ts:          setCachedMockData('journalEntries_' + userId, updatedCache);
src/hooks/useJournal.ts:          setCachedMockData(`journalEntry_${data.date}_${userId}`, data);
src/hooks/useJournal.ts:      setCachedMockData('journalEntries_' + userId, updatedCache);
src/hooks/useJournal.ts:      setCachedMockData(`journalEntry_${newEntry.date}_${userId}`, newEntry);
src/hooks/useJournal.ts:          setCachedMockData(`journalEntry_${date}_${userId}`, data);
src/hooks/useJournal.ts:          setCachedMockData('journalEntries_' + userId, updatedEntries);
src/hooks/useJournal.ts:      setCachedMockData(`journalEntry_${updatedEntry.date}_${userId}`, updatedEntry);
src/hooks/useJournal.ts:      setCachedMockData('journalEntries_' + userId, updatedEntries);
src/lib/hook-template.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/lib/hook-template.ts:          setCachedMockData('your_entity_data', data);
src/lib/hook-template.ts:          setCachedMockData(`your_entity_${id}`, mockItem);
src/lib/hook-template.ts:          setCachedMockData(`your_entity_${id}`, data);
src/lib/hook-template.ts:        setCachedMockData('your_entity_data', updatedCache);
src/lib/hook-template.ts:        setCachedMockData(`your_entity_${data.id}`, data);
```

### Pattern: getCachedMockData
```
src/features/journal/hooks/useJournalMutations.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/journal/hooks/useJournalMutations.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[] || [];
src/features/journal/hooks/useJournalMutations.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[] || [];
src/features/journal/hooks/useJournalMutations.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[] || [];
src/features/journal/hooks/useJournalEntryByDate.ts:import { getCachedMockData } from '@/lib/mockDataCache';
src/features/journal/hooks/useJournalEntryByDate.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[];
src/features/journal/hooks/useJournalEntry.ts:import { getCachedMockData } from '@/lib/mockDataCache';
src/features/journal/hooks/useJournalEntry.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[];
src/features/journal/hooks/useJournalEntries.ts:import { getCachedMockData } from '@/lib/mockDataCache';
src/features/journal/hooks/useJournalEntries.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[];
src/features/journal/hooks/useSearchJournalEntries.ts:import { getCachedMockData } from '@/lib/mockDataCache';
src/features/journal/hooks/useSearchJournalEntries.ts:        const cachedData = getCachedMockData('journalEntries') as JournalEntry[];
src/features/calendar/hooks/useLessons.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/calendar/hooks/useLessons.ts:          const cachedData = getCachedMockData('lessons');
src/features/calendar/hooks/useLessons.ts:          const cachedData = getCachedMockData(cacheKey);
src/features/calendar/hooks/useLessons.ts:          const allLessons = getCachedMockData('lessons') as Lesson[] || [];
src/features/calendar/hooks/useLessons.ts:        const cachedLessons = getCachedMockData('lessons') as Lesson[] || [];
src/features/calendar/hooks/useLessons.ts:        const cachedLessons = getCachedMockData('lessons') as Lesson[] || [];
src/features/calendar/hooks/useLessons.ts:        const cachedLessons = getCachedMockData('lessons') as Lesson[] || [];
src/features/calendar/hooks/useLessons.ts:        const cachedLessons = getCachedMockData('lessons') as Lesson[] || [];
src/features/calendar/hooks/useLessons.ts:        const cachedEvents = getCachedMockData('calendar_events') as CalendarEvent[] || [];
src/features/repertoire/hooks/useMasterRepertoire.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/repertoire/hooks/useMasterRepertoire.ts:        const cachedData = getCachedMockData<MasterRepertoire[]>(cacheKey, []);
src/features/repertoire/hooks/useMasterRepertoire.ts:        const cachedData = getCachedMockData<MasterRepertoire[]>(cacheKey, []);
src/features/repertoire/hooks/useMasterRepertoire.ts:        const cachedPiece = getCachedMockData<MasterRepertoire | null>(cacheKey, null);
src/features/repertoire/hooks/useMasterRepertoire.ts:        const cachedPiece = getCachedMockData<MasterRepertoire | null>(cacheKey, null);
src/features/repertoire/hooks/useMasterRepertoire.ts:        const existingData = getCachedMockData<MasterRepertoire[]>('masterRepertoire', []) || generateMockMasterRepertoire();
src/features/repertoire/hooks/useMasterRepertoire.ts:        const existingData = getCachedMockData<MasterRepertoire[]>('masterRepertoire', []) || generateMockMasterRepertoire();
src/features/repertoire/hooks/useMasterRepertoire.ts:        const existingData = getCachedMockData<MasterRepertoire[]>('masterRepertoire', []) || generateMockMasterRepertoire();
src/features/repertoire/hooks/useStudentRepertoire.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/features/repertoire/hooks/useStudentRepertoire.ts:        const cachedMockData = getCachedMockData<StudentRepertoire[]>(mockCacheKey, []);
src/features/repertoire/hooks/useStudentRepertoire.ts:        const existingData = getCachedMockData<StudentRepertoire[]>(cacheKey, []) || [];
src/features/repertoire/hooks/useStudentRepertoire.ts:        const existingData = getCachedMockData<StudentRepertoire[]>(cacheKey, []) || [];
src/features/repertoire/hooks/useStudentRepertoire.ts:            const data = getCachedMockData<StudentRepertoire[]>(key.replace('mock_', ''), []) || [];
src/components/lessons/AllLessonsLoader.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/components/lessons/AllLessonsLoader.ts:    const cachedData = getCachedMockData<string>(CACHE_KEY, '');
src/components/lessons/AllLessonsLoader.ts:    const cachedData = getCachedMockData<string>(CACHE_KEY, '');
src/hooks/usePieceStudentHistory.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/hooks/usePieceStudentHistory.ts:      const cachedData = getCachedMockData<StudentHistory[]>(cacheKey, []);
src/hooks/useRepertoireLinks.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/hooks/useRepertoireLinks.ts:      const cachedData = getCachedMockData<(RepertoireLink & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireLinks.ts:        const cachedData = getCachedMockData<(RepertoireLink & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireLinks.ts:        const cachedData = getCachedMockData<(RepertoireLink & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireFiles.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/hooks/useRepertoireFiles.ts:      const cachedData = getCachedMockData<(RepertoireFile & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireFiles.ts:        const cachedData = getCachedMockData<(RepertoireFile & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireFiles.ts:        const cachedData = getCachedMockData<(RepertoireFile & { _source?: string })[]>(cacheKey, []);
src/hooks/useStudentProfile.ts:import { setCachedMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useStudentProfile.ts:        let cachedData = getCachedMockData<Student | null>(`student-profile_${studentId}`, null);
src/hooks/useStudentProfile.ts:          cachedData = getCachedMockData<Student | null>(`student_${studentId}`, null);
src/hooks/useStudentProfile.ts:          let cachedData = getCachedMockData<Student | null>(`student-profile_${studentId}`, null);
src/hooks/useStudentProfile.ts:            cachedData = getCachedMockData<Student | null>(`student_${studentId}`, null);
src/hooks/useStudentProfile.ts:        const cachedData = getCachedMockData<Lesson | null>(cacheKey, null);
src/hooks/useStudentProfile.ts:          const cachedData = getCachedMockData<Lesson | null>(cacheKey, null);
src/hooks/useStudents.ts:import { setCachedMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useStudents.ts:        const cachedData = getCachedMockData<Student[] | null>('students', null);
src/hooks/useStudents.ts:          const cachedData = getCachedMockData<Student[] | null>('students', null);
src/hooks/useStudents.ts:        const cachedData = getCachedMockData<Student | null>(cacheKey, null);
src/hooks/useStudents.ts:          const cachedData = getCachedMockData<Student | null>(cacheKey, null);
src/hooks/useStudents.ts:        const cachedStudents = getCachedMockData<Student[]>('students', []);
src/hooks/useStudents.ts:        const cachedStudents = getCachedMockData<Student[]>('students', []);
src/hooks/useTeacher.ts:import { cacheMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useTeacher.ts:          const cachedData = getCachedMockData<Profile | null>('teacher_profile', null);
src/hooks/useTeacher.ts:          const cachedData = getCachedMockData<Profile | null>('teacher_profile', null);
src/hooks/useJournal.ts:import { setCachedMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useJournal.ts:        const cachedEntries = getCachedMockData<JournalEntry[]>('journalEntries_' + userId, []);
src/hooks/useJournal.ts:        const cachedEntry = getCachedMockData<JournalEntry | null>(
src/hooks/useJournal.ts:        const cachedEntry = getCachedMockData<JournalEntry | null>(
src/hooks/useJournal.ts:          const cachedEntries = getCachedMockData<JournalEntry[]>('journalEntries_' + userId, []);
src/hooks/useJournal.ts:      const cachedEntries = getCachedMockData<JournalEntry[]>('journalEntries_' + userId, []);
src/hooks/useJournal.ts:          const cachedEntries = getCachedMockData<JournalEntry[]>('journalEntries_' + userId, []);
src/hooks/useJournal.ts:      const cachedEntries = getCachedMockData<JournalEntry[]>('journalEntries_' + userId, []);
src/hooks/useStudentRepertoire.ts:import { cacheMockData, getCachedMockData } from '@/lib/mockDataCache';
src/hooks/useStudentRepertoire.ts:          const cachedData = getCachedMockData<EnhancedStudentRepertoire[] | null>(
src/hooks/useStudentRepertoire.ts:          const cachedData = getCachedMockData<EnhancedStudentRepertoire[] | null>(
src/hooks/useStudentRepertoire.ts:          const cachedData = getCachedMockData<EnhancedStudentRepertoire[] | null>(
src/hooks/useStudentRepertoire.ts:          const cachedData = getCachedMockData<EnhancedStudentRepertoire[] | null>(
src/lib/hook-template.ts:import { getCachedMockData, setCachedMockData } from '@/lib/mockDataCache';
src/lib/hook-template.ts:        const cachedData = getCachedMockData<YourEntityType[] | null>('your_entity_data', null);
src/lib/hook-template.ts:        const cachedData = getCachedMockData<YourEntityType[] | null>('your_entity_data', null);
src/lib/hook-template.ts:          const cachedData = getCachedMockData<YourEntityType | null>(`your_entity_${id}`, null);
src/lib/hook-template.ts:          const cachedData = getCachedMockData<YourEntityType | null>(`your_entity_${id}`, null);
src/lib/hook-template.ts:        const cachedEntities = getCachedMockData<YourEntityType[]>('your_entity_data', []);
```

### Hooks potentially missing hybrid caching
```
src/features/journal/hooks/useJournalInsights.ts
src/features/calendar/hooks/useCalendarMutations.ts
src/features/calendar/hooks/useCalendarEvents.ts
src/features/calendar/hooks/useCalendarEvent.ts
src/features/repertoire/hooks/usePieceStudentHistory.ts
src/features/repertoire/hooks/useRepertoireLinks.ts
src/features/repertoire/hooks/useRepertoireFiles.ts
src/features/user/hooks/useUserProfile.ts
src/hooks/useStudentsDb.ts
src/hooks/useUserRoles.ts
src/hooks/useCalendarEvents.ts
src/hooks/useRepertoireAttachments.ts
src/hooks/useInvitations.ts
```
Total hooks potentially missing caching: 13

## 5. UUID Validation
Hooks should validate UUIDs before querying Supabase:

### isValidUUID usage
```
src/features/repertoire/hooks/useStudentRepertoire.ts:import { isValidUUID } from '@/lib/id-utils';
src/features/repertoire/hooks/useStudentRepertoire.ts:        if (isValidUUID(studentId)) {
src/features/dashboard/pages/Dashboard.tsx:import { ID_PREFIXES, createPrefixedId, isValidUUID } from '@/lib/id-utils';
src/lib/hook-template.ts:import { isValidUUID } from '@/lib/id-utils';
src/lib/hook-template.ts:        if (isDevelopmentMode && !isValidUUID(id)) {
```

### Hooks potentially missing UUID validation
```
src/features/journal/hooks/useJournalMutations.ts
src/features/journal/hooks/useJournalEntry.ts
src/features/calendar/hooks/useCalendarMutations.ts
src/features/calendar/hooks/useLessons.ts
src/features/calendar/hooks/useCalendarEvent.ts
src/features/repertoire/hooks/usePieceStudentHistory.ts
src/features/repertoire/hooks/useRepertoireLinks.ts
src/features/repertoire/hooks/useRepertoireFiles.ts
src/features/repertoire/hooks/useMasterRepertoire.ts
src/hooks/useStudentsDb.ts
src/hooks/usePieceStudentHistory.ts
src/hooks/useRepertoireLinks.ts
src/hooks/useRepertoireFiles.ts
src/hooks/useStudents.ts
src/hooks/useCalendarEvents.ts
src/hooks/useJournal.ts
src/hooks/useRepertoireAttachments.ts
```
Total hooks potentially missing UUID validation: 17

## 6. Data Source Tracking
Components should track the data source (database, cache, mock) for debugging:

### _source tracking usage
```
src/types/schema_extensions.ts:  _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback';
src/features/journal/types.ts:  _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback';
src/features/journal/components/JournalEntry.tsx:            {isDevelopmentMode && entry._source && (
src/features/journal/components/JournalEntry.tsx:                entry._source === 'database' ? 'default' :
src/features/journal/components/JournalEntry.tsx:                entry._source.includes('cached') ? 'secondary' :
src/features/journal/components/JournalEntry.tsx:                {entry._source}
src/features/journal/hooks/useJournalEntries.ts:  _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback';
src/features/journal/pages/Journal.tsx:                    {isDevelopmentMode && selectedEntry && selectedEntry._source && (
src/features/journal/pages/Journal.tsx:                        selectedEntry._source === 'database' ? 'default' :
src/features/journal/pages/Journal.tsx:                        selectedEntry._source.includes('cached') ? 'secondary' :
src/features/journal/pages/Journal.tsx:                        {selectedEntry._source}
src/features/journal/pages/Journal.tsx:                          {isDevelopmentMode && selectedEntry && selectedEntry._source && (
src/features/journal/pages/Journal.tsx:                              selectedEntry._source === 'database' ? 'default' :
src/features/journal/pages/Journal.tsx:                              selectedEntry._source.includes('cached') ? 'secondary' :
src/features/journal/pages/Journal.tsx:                              {selectedEntry._source}
src/features/journal/pages/Journal.tsx:                                  {isDevelopmentMode && entry._source && (
src/features/journal/pages/Journal.tsx:                                      entry._source === 'database' ? 'default' :
src/features/journal/pages/Journal.tsx:                                      entry._source.includes('cached') ? 'secondary' :
src/features/journal/pages/Journal.tsx:                                      {entry._source}
src/features/repertoire/components/PieceCard.tsx:          {showSource && piece._source && (
src/features/repertoire/components/PieceCard.tsx:                <span>Source: {piece._source}</span>
src/features/repertoire/hooks/usePieceStudentHistory.ts:  _source?: HistorySourceType;
src/features/repertoire/hooks/usePieceStudentHistory.ts:            _source: 'api' as HistorySourceType
src/features/repertoire/hooks/usePieceStudentHistory.ts:          return cachedData.map(entry => ({ ...entry, _source: 'cache' as HistorySourceType }));
src/features/repertoire/hooks/usePieceStudentHistory.ts:            return mockStudentHistory[pieceId].map(entry => ({ ...entry, _source: 'mock' as HistorySourceType }));
src/features/repertoire/hooks/usePieceStudentHistory.ts:              _source: 'mock' as HistorySourceType
src/features/repertoire/hooks/usePieceStudentHistory.ts:              _source: 'mock' as HistorySourceType
src/features/repertoire/hooks/useRepertoireLinks.ts:  return useQuery<(RepertoireLink & { _source?: LinkSourceType })[]>({
src/features/repertoire/hooks/useRepertoireLinks.ts:          return data.map(link => ({ ...link, _source: 'api' as LinkSourceType }));
src/features/repertoire/hooks/useRepertoireLinks.ts:          return cachedData.map(link => ({ ...link, _source: 'cache' as LinkSourceType }));
src/features/repertoire/hooks/useRepertoireLinks.ts:            return mockLinks[pieceId].map(link => ({ ...link, _source: 'mock' as LinkSourceType }));
src/features/repertoire/hooks/useRepertoireLinks.ts:          return mockLinkData.map(link => ({ ...link, _source: 'mock' as LinkSourceType }));
src/features/repertoire/hooks/useRepertoireLinks.ts:          return cachedData.map(link => ({ ...link, _source: 'cache' as LinkSourceType }));
src/features/repertoire/hooks/useRepertoireLinks.ts:          return mockLinks[pieceId].map(link => ({ ...link, _source: 'mock' as LinkSourceType }));
src/features/repertoire/hooks/useRepertoireFiles.ts:  return useQuery<(RepertoireFile & { _source?: FileSourceType })[]>({
src/features/repertoire/hooks/useRepertoireFiles.ts:          return data.map(file => ({ ...file, _source: 'api' as FileSourceType }));
src/features/repertoire/hooks/useRepertoireFiles.ts:          return cachedData.map(file => ({ ...file, _source: 'cache' as FileSourceType }));
src/features/repertoire/hooks/useRepertoireFiles.ts:            return mockFiles[pieceId].map(file => ({ ...file, _source: 'mock' as FileSourceType }));
src/features/repertoire/hooks/useRepertoireFiles.ts:          return mockFileData.map(file => ({ ...file, _source: 'mock' as FileSourceType }));
src/features/repertoire/hooks/useRepertoireFiles.ts:          return cachedData.map(file => ({ ...file, _source: 'cache' as FileSourceType }));
src/features/repertoire/hooks/useRepertoireFiles.ts:          return mockFiles[pieceId].map(file => ({ ...file, _source: 'mock' as FileSourceType }));
src/features/repertoire/hooks/useMasterRepertoire.ts:  return useQuery<(MasterRepertoire & { _source?: string })[]>({
src/features/repertoire/hooks/useMasterRepertoire.ts:          return data.map(item => ({...item, _source: 'database'}));
src/features/repertoire/hooks/useMasterRepertoire.ts:          return cachedData.map(item => ({...item, _source: error ? 'cached-fallback' : 'cached'}));
src/features/repertoire/hooks/useMasterRepertoire.ts:        return mockData.map(item => ({...item, _source: 'mock-fallback'}));
src/features/repertoire/hooks/useMasterRepertoire.ts:          return cachedData.map(item => ({...item, _source: 'cached-fallback'}));
src/features/repertoire/hooks/useMasterRepertoire.ts:        return mockData.map(item => ({...item, _source: 'mock-fallback'}));
src/features/repertoire/hooks/useMasterRepertoire.ts:            return { ...data, _source: 'database' };
src/features/repertoire/hooks/useMasterRepertoire.ts:            return { ...exactMatch, _source: exactMatch._source || 'cached' };
src/features/repertoire/hooks/useMasterRepertoire.ts:          return { ...cachedPiece, _source: 'cached' };
src/features/repertoire/hooks/useMasterRepertoire.ts:              _source: 'mock-fallback' 
src/features/repertoire/hooks/useMasterRepertoire.ts:          return { ...cachedPiece, _source: 'cached-fallback' };
src/features/repertoire/hooks/useStudentRepertoire.ts:            return data.map(item => ({ ...item, _source: 'database' }));
src/features/repertoire/hooks/useStudentRepertoire.ts:          return cachedData.map(item => ({ ...item, _source: 'cached' }));
src/features/repertoire/hooks/useStudentRepertoire.ts:          return cachedData.map(item => ({ ...item, _source: 'cached' }));
src/features/repertoire/hooks/useStudentRepertoire.ts:          return cachedMockData.map(item => ({ ...item, _source: 'mock' }));
src/features/repertoire/hooks/useStudentRepertoire.ts:        return mockData.map(item => ({ ...item, _source: 'mock' }));
src/features/repertoire/pages/PieceDetails.tsx:type MasterRepertoireWithSource = MasterRepertoire & { _source?: 'api' | 'cache' | 'mock' };
src/features/repertoire/pages/PieceDetails.tsx:        _source: 'mock'
src/features/repertoire/pages/PieceDetails.tsx:      _source: (masterPiece as any)._source || 'mock'
src/features/repertoire/pages/PieceDetails.tsx:            {(safePiece as any)._source && (
src/features/repertoire/pages/PieceDetails.tsx:              <Badge variant={(safePiece as any)._source === 'api' ? 'outline' : 'secondary'}>
src/features/repertoire/pages/PieceDetails.tsx:                Source: {(safePiece as any)._source}
src/features/repertoire/pages/PieceDetails.tsx:                    {file._source && (
src/features/repertoire/pages/PieceDetails.tsx:                          file._source === 'api' ? 'outline' : 
src/features/repertoire/pages/PieceDetails.tsx:                          file._source === 'cache' ? 'secondary' : 
src/features/repertoire/pages/PieceDetails.tsx:                        {file._source}
src/features/repertoire/pages/PieceDetails.tsx:                    {link._source && (
src/features/repertoire/pages/PieceDetails.tsx:                          link._source === 'api' ? 'outline' : 
src/features/repertoire/pages/PieceDetails.tsx:                          link._source === 'cache' ? 'secondary' : 
src/features/repertoire/pages/PieceDetails.tsx:                        {link._source}
src/features/repertoire/pages/PieceDetails.tsx:                            {student._source && (
src/features/repertoire/pages/PieceDetails.tsx:                              <Badge variant={student._source === 'api' ? 'outline' : 'secondary'} className="text-xs">
src/features/repertoire/pages/PieceDetails.tsx:                                {student._source}
src/features/repertoire/pages/PieceDetails.tsx:                            {student._source && (
src/features/repertoire/pages/PieceDetails.tsx:                              <Badge variant={student._source === 'api' ? 'outline' : 'secondary'} className="text-xs">
src/features/repertoire/pages/PieceDetails.tsx:                                {student._source}
src/features/repertoire/pages/Repertoire.tsx:          _source: (item as any)._source
src/features/students/pages/Students.tsx:        {(student as any)._source && (
src/features/students/pages/Students.tsx:              (student as any)._source === 'database' ? 'outline' : 
src/features/students/pages/Students.tsx:              (student as any)._source === 'cached' ? 'secondary' : 
src/features/students/pages/Students.tsx:            {(student as any)._source}
src/features/students/pages/StudentDetail.tsx:      // Preserve the _source property from our hybrid caching approach
src/features/students/pages/StudentDetail.tsx:      _source: lesson._source
src/features/students/pages/StudentDetail.tsx:              {(studentData as any)?._source && (
src/features/students/pages/StudentDetail.tsx:                    (studentData as any)._source === 'database' ? 'outline' : 
src/features/students/pages/StudentDetail.tsx:                    (studentData as any)._source === 'cached' ? 'secondary' : 
src/features/students/pages/StudentDetail.tsx:                  {(studentData as any)._source}
src/components/common/PieceCard.tsx:              {showSource && (piece as any)._source && (
src/components/common/PieceCard.tsx:                    (piece as any)._source === 'database' ? 'outline' : 
src/components/common/PieceCard.tsx:                    (piece as any)._source === 'cached' ? 'secondary' : 
src/components/common/PieceCard.tsx:                  {(piece as any)._source}
src/components/common/StudentCard.tsx:  _source?: 'api' | 'cache' | 'mock';
src/components/examples/MigrationExampleComponent.tsx:                      (piece as any)._source === 'database' ? 'outline' : 
src/components/examples/MigrationExampleComponent.tsx:                      (piece as any)._source?.includes('cached') ? 'secondary' : 
src/components/examples/MigrationExampleComponent.tsx:                      {(piece as any)._source || 'unknown'}
src/components/lessons/AllLessonsLoader.ts:  _source?: string;
src/components/lessons/AllLessonsLoader.ts:  _source: 'database' | 'cached' | 'mock';
src/components/lessons/AllLessonsLoader.ts:          _source: 'database'
src/components/lessons/AllLessonsLoader.ts:            _source: 'cached'
src/components/lessons/AllLessonsLoader.ts:            _source: 'cached'
src/components/lessons/AllLessonsLoader.ts:      _source: 'mock'
src/components/lessons/AllLessonsTable.tsx:    const sourceType = lesson._source || 'unknown';
src/components/dev/HookHealthDashboard.tsx:export function registerHookSource<T extends { _source?: string }>(
src/components/dev/HookHealthDashboard.tsx:    ? (data[0]?._source || 'unknown') 
src/components/dev/HookHealthDashboard.tsx:    : (data._source || 'unknown');
src/hooks/usePieceStudentHistory.ts:  _source?: 'database' | 'cached' | 'mock';
src/hooks/usePieceStudentHistory.ts:    _source: 'mock'
src/hooks/usePieceStudentHistory.ts:    _source: 'mock'
src/hooks/usePieceStudentHistory.ts:    _source: 'mock'
src/hooks/usePieceStudentHistory.ts:    _source: 'mock'
src/hooks/usePieceStudentHistory.ts:              _source: 'database' as const
src/hooks/usePieceStudentHistory.ts:          _source: 'cached' as const
src/hooks/usePieceStudentHistory.ts:      // For mock data, use a clean copy with properly typed _source
src/hooks/usePieceStudentHistory.ts:        _source: 'mock' as const
src/hooks/useRepertoireLinks.ts:  return useQuery<(RepertoireLink & { _source?: string })[]>({
src/hooks/useRepertoireLinks.ts:            _source: 'database'
src/hooks/useRepertoireLinks.ts:      const cachedData = getCachedMockData<(RepertoireLink & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireLinks.ts:          _source: 'cached'
src/hooks/useRepertoireLinks.ts:          _source: 'mock'
src/hooks/useRepertoireLinks.ts:        const cachedData = getCachedMockData<(RepertoireLink & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireLinks.ts:            { ...data, _source: 'cached' }
src/hooks/useRepertoireLinks.ts:        const cachedData = getCachedMockData<(RepertoireLink & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireFiles.ts:  return useQuery<(RepertoireFile & { _source?: string })[]>({
src/hooks/useRepertoireFiles.ts:            _source: 'database'
src/hooks/useRepertoireFiles.ts:      const cachedData = getCachedMockData<(RepertoireFile & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireFiles.ts:          _source: 'cached'
src/hooks/useRepertoireFiles.ts:          _source: 'mock'
src/hooks/useRepertoireFiles.ts:        const cachedData = getCachedMockData<(RepertoireFile & { _source?: string })[]>(cacheKey, []);
src/hooks/useRepertoireFiles.ts:            { ...data, _source: 'cached' }
src/hooks/useRepertoireFiles.ts:        const cachedData = getCachedMockData<(RepertoireFile & { _source?: string })[]>(cacheKey, []);
src/hooks/useStudentProfile.ts:            _source: 'database' as const
src/hooks/useStudentProfile.ts:          console.log(`Returning data with _source added:`, enhancedData);
src/hooks/useStudentProfile.ts:            _source: 'cached' as const
src/hooks/useStudentProfile.ts:          console.log(`Returning cached data with _source added:`, enhancedData);
src/hooks/useStudentProfile.ts:            _source: 'mock' as const
src/hooks/useStudentProfile.ts:              _source: 'cached-fallback'
src/hooks/useStudentProfile.ts:            _source: 'mock-fallback'
src/hooks/useStudentProfile.ts:              _source: 'database'
src/hooks/useStudentProfile.ts:            _source: 'database'
src/hooks/useStudentProfile.ts:            _source: 'cached'
src/hooks/useStudentProfile.ts:            _source: 'mock'
src/hooks/useStudentProfile.ts:              _source: 'cached-fallback'
src/hooks/useStudentProfile.ts:            _source: 'mock-fallback'
src/hooks/useStudents.ts:  _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback';
src/hooks/useStudents.ts:            _source: 'database'
src/hooks/useStudents.ts:            _source: 'cached'
src/hooks/useStudents.ts:            _source: 'mock' 
src/hooks/useStudents.ts:              _source: 'cached-fallback'
src/hooks/useStudents.ts:            _source: 'mock-fallback' 
src/hooks/useStudents.ts:            _source: 'database'
src/hooks/useStudents.ts:            _source: 'cached'
src/hooks/useStudents.ts:              _source: 'mock'
src/hooks/useStudents.ts:              _source: 'cached-fallback'
src/hooks/useStudents.ts:              _source: 'mock-fallback'
src/hooks/useJournal.ts:  return useQuery<(JournalEntry & { _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback' })[]>({
src/hooks/useJournal.ts:            _source: 'database'
src/hooks/useJournal.ts:            _source: 'cached-fallback'
src/hooks/useJournal.ts:          _source: 'mock-fallback'
src/hooks/useJournal.ts:  return useQuery<(JournalEntry & { _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback' }) | null>({
src/hooks/useJournal.ts:            _source: 'database' as const
src/hooks/useJournal.ts:            _source: 'cached-fallback'
src/hooks/useJournal.ts:            _source: 'mock-fallback'
src/hooks/useJournal.ts:  return useQuery<(JournalEntry & { _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback' }) | null>({
src/hooks/useJournal.ts:            _source: 'database'
src/hooks/useJournal.ts:            _source: 'cached-fallback'
src/hooks/useJournal.ts:            _source: 'mock-fallback'
src/hooks/useJournal.ts:            _source: 'database' as const
src/hooks/useJournal.ts:        _source: 'mock-fallback' as const
src/backup-pre-migration-20250319205821/pages/Students.tsx:        {(student as any)._source && (
src/backup-pre-migration-20250319205821/pages/Students.tsx:              (student as any)._source === 'database' ? 'outline' : 
src/backup-pre-migration-20250319205821/pages/Students.tsx:              (student as any)._source === 'cached' ? 'secondary' : 
src/backup-pre-migration-20250319205821/pages/Students.tsx:            {(student as any)._source}
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:      _source: (masterPiece as any)._source
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                    {file._source && (
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                          file._source === 'database' ? 'outline' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                          file._source === 'cached' ? 'secondary' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                        {file._source}
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                    {link._source && (
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                          link._source === 'database' ? 'outline' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                          link._source === 'cached' ? 'secondary' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                        {link._source}
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                            {student._source && (
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                                  student._source === 'database' ? 'outline' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                                  student._source === 'cached' ? 'secondary' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                                {student._source}
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                            {student._source && (
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                                  student._source === 'database' ? 'outline' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                                  student._source === 'cached' ? 'secondary' : 
src/backup-pre-migration-20250319205821/pages/PieceDetails.tsx:                                {student._source}
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                    {isDevelopmentMode && selectedEntry && selectedEntry._source && (
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                        selectedEntry._source === 'database' ? 'default' :
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                        selectedEntry._source.includes('cached') ? 'secondary' :
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                        {selectedEntry._source}
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                          {isDevelopmentMode && selectedEntry && selectedEntry._source && (
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                              selectedEntry._source === 'database' ? 'default' :
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                              selectedEntry._source.includes('cached') ? 'secondary' :
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                              {selectedEntry._source}
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                                  {isDevelopmentMode && entry._source && (
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                                      entry._source === 'database' ? 'default' :
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                                      entry._source.includes('cached') ? 'secondary' :
src/backup-pre-migration-20250319205821/pages/Journal.tsx:                                      {entry._source}
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:      // Preserve the _source property from our hybrid caching approach
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:      _source: lesson._source
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:              {(studentData as any)?._source && (
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:                    (studentData as any)._source === 'database' ? 'outline' : 
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:                    (studentData as any)._source === 'cached' ? 'secondary' : 
src/backup-pre-migration-20250319205821/pages/StudentDetail.tsx:                  {(studentData as any)._source}
src/lib/hook-template.ts:  _source?: 'database' | 'cached' | 'mock' | 'cached-fallback' | 'mock-fallback';
src/lib/hook-template.ts:            _source: 'database' as const
src/lib/hook-template.ts:            _source: 'cached' as const
src/lib/hook-template.ts:          _source: 'mock' as const
src/lib/hook-template.ts:            _source: 'cached-fallback' as const
src/lib/hook-template.ts:          _source: 'mock-fallback' as const
src/lib/hook-template.ts:              _source: 'cached' as const
src/lib/hook-template.ts:            _source: 'mock' as const
src/lib/hook-template.ts:            _source: 'database' as const
src/lib/hook-template.ts:              _source: 'cached-fallback' as const
src/lib/hook-template.ts:            _source: 'mock-fallback' as const
src/lib/hook-template.ts:    mutationFn: async (newEntity: Omit<YourEntityType, 'id' | '_source'>) => {
```

### Hooks potentially missing source tracking
```
src/features/journal/hooks/useJournalMutations.ts
src/features/journal/hooks/useJournalEntryByDate.ts
src/features/journal/hooks/useJournalEntry.ts
src/features/journal/hooks/useSearchJournalEntries.ts
src/features/calendar/hooks/useLessons.ts
src/features/user/hooks/useUserProfile.ts
src/hooks/useStudentsDb.ts
src/hooks/useUserRoles.ts
src/hooks/useTeacher.ts
src/hooks/useRepertoireAttachments.ts
src/hooks/useStudentRepertoire.ts
src/hooks/useInvitations.ts
```
Total hooks potentially missing source tracking: 12

## Audit Summary

| Category | Potential Issues |
|----------|------------------|
| Non-UUID String IDs | 6 |
| ID Prefix Creation | 59 |
| Missing UUID Imports | 39 |
| Missing Hybrid Caching | 13 |
| Missing UUID Validation | 17 |
| Missing Source Tracking | 12 |

